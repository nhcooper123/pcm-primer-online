# Answers to practical exercises

Below are all the questions and answers to the practical exercises at the end of each exercise. 

## Data Wrangling

Using the `frog-eyes-raw-data.csv` data and R, create a new dataframe that contains only the columns `genus_species`, `Family`, and two new columns containing the *species mean values* for `rootmass` and `eyemean`. Note that we will talk more about this dataset in later exercises, but it comes from (Thomas et al 2020 ADD CITATION)

There are multiple ways of doing this, but the easiest is as follows:
```{r}
# Load packages
library(tidyverse)

# Read in the data
frog <- read_csv("data/frog-eyes-raw-data.csv")
# Take a look at it
glimpse(frog)

# Create a new dataframe called frog2
frog2 <-
  # Start with the frog dataframe
  frog %>%
  # Select only the columns of interest
  select(genus_species, Family, rootmass, eyemean) %>%
  # Group by species name, and Family (or summarise will try and average this too!)
  group_by(genus_species, Family) %>%
  # Summarise to get the mean values
  summarise(mean_rootmass = mean(rootmass),
            mean_eyemean = mean(eyemean))

# Look at frog2
glimpse(frog2)

# Write to file
# This is commented out as I don't want to save this
# write_csv(frog2, path = "data/clean-frog-data.csv")
```

## Phylogenies

Using the `frog-tree.nex` phylogeny, see if you can do the following. Note that we will talk more about this tree in later exercises, but it comes Feng et al. (2019), and was modified in Thomas et al 2020 ADD CITATION).

1. Read the tree into R.
```{r}
# Load packages
library(ape)
library(ggtree)
library(tidyverse)

# Read in the tree
tree <- read.nexus("data/frog-tree.nex")

# Look at it
tree
```
2. Use R functions to determine: 
    a) how many species are in the tree?
    
```{r}
# Look at the tree structure
str(tree)
# Or the whole tree
tree

# There are 214 tips
```
    b) is the tree fully resolved?
```{r}
# Check whether the tree is binary/fully resolved
is.binary.tree(tree)
# Yes it is!
```
    c) is the tree rooted?
```{r}
# Check whether the tree is rooted
is.rooted(tree)
# Yes it is!
```    
3. Use `plot.phylo` to plot the tree.
    a) Can you change the size of the tip labels?
    b) Can you make a fan-shaped plot? 
    c) Can you change the colour of the tips and branches?
```{r}
# Plot the tree
plot(tree, 
     no.margin = TRUE, # to make sure it fills the whole space
     type = "fan", # to make a fan tree
     cex = 0.6, # to reduce the tip label size (default = 1)
     tip.color = "deeppink", # to change the tip colour
     edge.color = "springgreen") # to change the branch colour
# yuk!
```
4. Save the tree to file as "mysuperdoopertree.nex"    
```{r}
# Save the tree
# I've commented this out as I don't want to save it here.
# write.nexus(tree, file = "mysuperdoopertree.nex")
```    

EXTRA. Use ggtree and the ggtree manual to produce a phylogeny plot of this tree that you could use in a publication OR go make the most exotic looking tree you possibly can. Playing around with these packages is the best way to learn. If you make a particularly amazing or horrific tree, send us a screenshot!
